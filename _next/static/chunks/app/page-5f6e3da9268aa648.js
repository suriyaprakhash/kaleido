(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4447:function(e,t,r){Promise.resolve().then(r.bind(r,9109))},9109:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var n=r(7437),s=r(2265);class a{}class o extends a{convert(e){let t=[],r=[],n=new Map(Object.entries(e.contexts)),s=new Map,a=0;return n.forEach((e,n)=>{let o=new Map(Object.entries(e.beans));o.forEach((e,n)=>{var l;a+=1,s.has(e.type)?s.get(e.type):s.set(e.type,a+1),t.push({id:n,group:s.get(e.type)}),null===(l=e.dependencies)||void 0===l||l.forEach(e=>{o.get(e)&&o.get(n)?r.push({source:e,target:n,value:1}):console.error("Missing dependency node - "+e+" or bean Node -"+n)})})}),{links:r,nodes:t}}}var l=r(9944),i=e=>{let{jsonData:t}=e,r=(0,s.useRef)(!1),[a,o]=(0,s.useState)(t),[i,c]=(0,s.useState)(""),d=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(console.log("use Effects called"),!r.current){var e;console.log("use Effects called - init"),null===(e=l.td_("g"))||void 0===e||e.remove(),function(e){let t;let r=e.jsonData,n=e.svgRef,s=e.svgRefElementString;t=n?l.Ys(n.current):l.Ys(s);let a=e.width?e.width:1600,o=e.height?e.height:1200;t.attr("width",a).attr("height",o).attr("viewBox",[0,0,a,o]).attr("style","max-width: 100%; height: auto");let i=l.PKp(l.Cn1),c=r.links.map(e=>({...e})),d=r.nodes.map(e=>({...e})),u=t.append("g").attr("stroke","#999").attr("stroke-opacity",.6).selectAll().data(c).join("line").attr("stroke-width",e=>Math.sqrt(e.value)),h=t.append("g").attr("stroke","#fff").attr("stroke-width",1.5).selectAll().data(d).join("circle").attr("r",5).attr("fill",e=>i(e.group+""));h.append("title").text(e=>e.id);let f=l.A4v(d).force("link",l.Fsl(c).id(e=>e.id)).force("charge",l.q5i()).force("center",l.wqt(a/2,o/2)).on("tick",function(){u.attr("x1",e=>e.source.x).attr("y1",e=>e.source.y).attr("x2",e=>e.target.x).attr("y2",e=>e.target.y),h.attr("cx",e=>e.x?e.x:0).attr("cy",e=>e.y?e.y:0)}),p=l.sPX();p.on("zoom",function(e){h.attr("transform",e.transform),u.attr("transform",e.transform)}),t.call(p).append("g");let g=l.ohM();g.on("start",e=>{e.active||f.alphaTarget(.3).restart(),e.subject.fx=e.subject.x,e.subject.fy=e.subject.y}).on("drag",e=>{e.subject.fx=e.x,e.subject.fy=e.y}).on("end",e=>{e.active||f.alphaTarget(0),e.subject.fx=null,e.subject.fy=null}),h.call(g)}({jsonData:a,svgRef:d}),r.current=!0}},[a]),(0,n.jsx)("section",{className:"border-8 border-orange-600",children:(0,n.jsxs)("section",{className:"grid gap-4 border-8 border-red-100 p-2 sm:grid-cols-4",children:[(0,n.jsxs)("div",{className:"sm:col-span-1 border-4 border-green-800 grid grid-cols-2 p-4",children:[(0,n.jsx)("div",{className:"text-center col-span-2",children:"Data Window"}),(0,n.jsx)("div",{className:"col-span-2",children:"ForceDirectedGraph"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{children:["Nodes found - ",a.nodes.length]}),(0,n.jsxs)("p",{children:["Links found - ",a.links.length]})]}),(0,n.jsxs)("div",{className:"col-span-2 hidden lg:block",children:[(0,n.jsx)("h3",{className:"",children:"NODES"}),(0,n.jsx)("ul",{className:"list-disc overflow-y-auto h-56",children:a.nodes.map(e=>(0,n.jsx)("li",{children:e.id},e.id))})]})]}),(0,n.jsx)("div",{className:"sm:col-span-2 border-4 border-green-800 rounded-lg",children:(0,n.jsx)("svg",{ref:d,className:"border-4 border-green-400 rounded-lg"})}),(0,n.jsxs)("div",{className:"sm:col-span-1 border-4 border-green-800 grid grid-cols-2 p-4 h-1/2 ",children:[(0,n.jsx)("div",{className:"col-span-2 text-center",children:"Search Window"}),(0,n.jsx)("div",{className:"col-span-2 border-4 border-green-800",children:(0,n.jsx)("input",{className:"border-4 border-green-600 w-full",placeholder:"search",onChange:function(e){c(e.target.value)}})}),(0,n.jsxs)("div",{className:"col-span-2 grid grid-cols-2 gap-2 p-2",children:[(0,n.jsx)("button",{className:"col-span-1 bg-teal-600 rounded-lg",onClick:function(e){let n=t.nodes.filter(e=>e.id.toLocaleLowerCase().includes(i.toLocaleLowerCase())).map(e=>e),s=new Map;if(t.nodes.forEach(e=>s.set(e.id,e)),(null==n?void 0:n.length)>0){let e=t.links.filter(e=>n.filter(t=>e.source===t.id).length>0).map(e=>e),r=e.map(e=>s.get(e.target)),a=new Set;r.forEach(e=>{e&&a.add(e)}),n.forEach(e=>{a.add(e)}),o({nodes:Array.from(a),links:e})}else o({nodes:[],links:[]});r.current=!1},children:(0,n.jsx)("span",{className:"text-white",children:"Filter Depandents"})}),(0,n.jsx)("button",{className:"col-span-1 bg-teal-600 rounded-lg",onClick:function(e){let n=t.nodes.filter(e=>e.id.toLocaleLowerCase().includes(i.toLocaleLowerCase())).map(e=>e),s=new Map;if(t.nodes.forEach(e=>s.set(e.id,e)),(null==n?void 0:n.length)>0){let e=t.links.filter(e=>n.filter(t=>e.target===t.id).length>0).map(e=>e),r=e.map(e=>s.get(e.source)),a=new Set;r.forEach(e=>{e&&a.add(e)}),n.forEach(e=>{a.add(e)}),o({nodes:Array.from(a),links:e})}else o({nodes:[],links:[]});r.current=!1},children:(0,n.jsx)("span",{className:"p-2 text-white",children:"Filter Child"})})]})]})]})})};class c extends a{convert(e){let t={name:"contexts",children:[]};return new Map(Object.entries(e.contexts)).forEach((e,r)=>{let n={name:r,children:[]},s=new Map(Object.entries(e.beans));s.forEach((e,t)=>{let r={name:t,children:d(s,e)};n.children.push(r)}),t.children.push(n)}),t}}function d(e,t){let r=[];return null==t||t.dependencies.forEach(t=>{let n={name:t,children:d(e,e.get(t))};r.push(n)}),r}var u=e=>{let{convertedJsonData:t,actualJsonData:r}=e,a=(0,s.useRef)(!1),[o,i]=(0,s.useState)(t),[c,u]=(0,s.useState)(""),h=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(console.log("use Effects called"),!a.current){var e;console.log("use Effects called - init"),null===(e=l.td_("svg g"))||void 0===e||e.remove(),function(e){let t;let r=e.jsonData,n=e.svgRef,s=e.svgRefElementString;t=n?l.Ys(n.current):l.Ys(s);let a=e.width?e.width:1600;l.PKp(l.Cn1);let o=l.bT9(r),i=a/(o.height+1),c=l.ki8().nodeSize([50,i]);o.sort((e,t)=>l.j2p(e.data.name,t.data.name)),c(o);let d=1/0,u=-1/0;o.each(e=>{e.x>u&&(u=e.x),e.x<d&&(d=e.x)}),t.attr("width",a).attr("height",800).attr("viewBox",[-i/3,d-50,a,800]).attr("style","max-width: 100%; height: auto; font: 18px sans-serif;");let h=l.h5h().x(e=>e.y).y(e=>e.x),f=t.append("g");f.append("g").attr("fill","none").attr("stroke","#009fb8").attr("stroke-opacity",.4).attr("stroke-width",5).selectAll().data(o.links()).join("path").attr("d",h).on("mouseover",function(e,t){l.Ys(this).transition().duration(3).attr("stroke-width",10)}).on("mouseout",function(e,t){l.Ys(this).transition().duration(2).attr("stroke-width",5)});let p=f.append("g").attr("stroke-linejoin","round").attr("stroke-width",3).selectAll().data(o.descendants()).join("g").attr("transform",e=>"translate(".concat(e.y,",").concat(e.x,")"));p.append("circle").attr("fill",e=>e.children?"#00b834":"#b80000").attr("r",20).on("mouseover",function(e,t){l.Ys(this).transition().duration(3).attr("r",30)}).on("mouseout",function(e,t){l.Ys(this).transition().duration(2).attr("r",20)}),p.append("text").attr("dy","0.31em").attr("x",e=>e.children?-25:25).attr("text-anchor",e=>e.children?"end":"start").text(e=>e.data.name).attr("stroke","white").attr("paint-order","stroke").on("mouseover",function(e,t){l.Ys(this).transition().duration(3).attr("style","font: 36px sans-serif;")}).on("mouseout",function(e,t){l.Ys(this).transition().duration(2).attr("style","font: 18px sans-serif;")});let g=l.sPX();g.on("zoom",function(e){f.attr("transform",e.transform)}),t.call(g)}({jsonData:o,svgRef:h}),a.current=!0}},[o]),(0,n.jsx)("section",{className:"border-8 border-orange-600",children:(0,n.jsxs)("section",{className:"grid gap-4 border-8 border-red-100 p-2 sm:grid-cols-4",children:[(0,n.jsx)("div",{className:"sm:col-span-3 border-4 border-green-800 rounded-lg",children:(0,n.jsx)("svg",{ref:h,className:"border-4 border-green-400 rounded-lg"})}),(0,n.jsxs)("div",{className:"sm:col-span-1 border-4 border-green-800 grid grid-cols-2 p-4 h-1/2 ",children:[(0,n.jsx)("div",{className:"col-span-2 text-center",children:"Search Window"}),(0,n.jsx)("div",{className:"col-span-2 border-4 border-green-800",children:(0,n.jsx)("input",{className:"border-4 border-green-600 w-full",placeholder:"search",onChange:function(e){u(e.target.value)}})}),(0,n.jsx)("div",{className:"col-span-2 grid grid-cols-2 gap-2 p-2",children:(0,n.jsx)("button",{className:"col-span-1 bg-teal-600 rounded-lg",onClick:function(e){i(function(e,t){let r={name:"contexts",children:[]};return new Map(Object.entries(e.contexts)).forEach((e,n)=>{let s={name:n,children:[]},a=new Map(Object.entries(e.beans));a.forEach((e,r)=>{if(r.toLocaleLowerCase().includes(null==t?void 0:t.toLocaleLowerCase())){let t={name:r,children:d(a,e)};s.children.push(t)}}),r.children.push(s)}),r}(r,c)),a.current=!1},children:(0,n.jsx)("span",{className:"text-white",children:"Find Path"})})})]})]})})},h=function(e){let{actualJsonData:t,actuatorType:r,parentCallback:a}=e,[l,d]=(0,s.useState)("defaultTreeGraph"===r?"tree":"force"),h=f(r,t,l);function f(e,t,r){if("defaultForceDirectedGraph"===e||"defaultTreeGraph"===e)return t;if("actuatorBeansJson"===e){if("force"===r)return new o().convert(t);if("tree"===r)return new c().convert(t)}return{links:[],nodes:[]}}return(0,n.jsxs)("section",{children:[(0,n.jsxs)("section",{className:"border-4 border-red-800 grid grid-cols-12 p-2",children:[(0,n.jsx)("div",{className:"col-span-10 border-4 border-red-700 p-2",children:(0,n.jsxs)("button",{onClick:function(e){console.log("Selected - "+e.target.id),("force"===e.target.id||"tree"===e.target.id)&&(h=f(r,t,e.target.id),d(e.target.id))},className:"relative group transition-all duration-200 focus:overflow-visible w-max h-max p-2 overflow-hidden flex flex-row items-center justify-center bg-white gap-2 rounded-lg border border-zinc-200",children:[(0,n.jsx)("span",{children:"Select visulaization to switch"}),(0,n.jsx)("svg",{className:"rotate-90 group-focus:rotate-180",xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{fill:"currentColor",d:"m12 10.8l-3.9 3.9q-.275.275-.7.275t-.7-.275q-.275-.275-.275-.7t.275-.7l4.6-4.6q.3-.3.7-.3t.7.3l4.6 4.6q.275.275.275.7t-.275.7q-.275.275-.7.275t-.7-.275z"})}),(0,n.jsxs)("div",{className:"absolute shadow-lg -bottom-40 left-0 w-full h-max p-2 bg-white border border-zinc-200 rounded-lg flex flex-col gap-2",children:[(0,n.jsx)("span",{id:"force",className:"flex flex-row gap-2 items-center hover:bg-zinc-100 p-2 rounded-lg",children:(0,n.jsx)("p",{id:"force",children:"Force directed graph"})}),(0,n.jsx)("span",{id:"tree",className:"flex flex-row gap-2 items-center hover:bg-zinc-100 p-2 rounded-lg",children:(0,n.jsx)("p",{id:"tree",children:"Tree graph"})})]})]})}),(0,n.jsx)("div",{className:"col-span-2 border-4 border-red-400 flex flex-col p-2",children:(0,n.jsx)("button",{className:"bg-teal-600 rounded-lg p-3",onClick:function(){a(void 0)},children:(0,n.jsx)("span",{className:"text-white",children:"Go Back"})})})]}),"force"===l?(0,n.jsx)(i,{jsonData:h}):"tree"===l?(0,n.jsx)(u,{convertedJsonData:h,actualJsonData:t}):void 0]})};class f{isEmpty(e){return 0===e.length}twoOrMoreFile(e){return e.length>1}}class p extends f{validate(e){return this.isEmpty(e)?{isValid:!1,errorMessage:"No file provided"}:this.twoOrMoreFile(e)?{isValid:!1,errorMessage:"More than one file provided"}:this.isJson(e[0])?{isValid:!0}:{isValid:!1,errorMessage:"The file is not a JSON"}}isJson(e){return"application/json"===e.type}}let g=new p;class x{static isDefaultForceDirectedGraphTypeGuard(e){return"object"==typeof e&&"nodes"in e&&"links"in e}}class m{static isDefaultTreeGraphTypeGuard(e){return"object"==typeof e&&"name"in e&&m.checkChildren(e)}static checkChildren(e){return"children"in e}}class b{static isBeansJson(e){return"object"==typeof e&&null!==e&&"contexts"in e&&e.contexts instanceof Object&&Object.entries(e.contexts).length>0&&(new Map(Object.entries(e.contexts)).forEach((e,t)=>{if(!(e.beans instanceof Object))return!1}),!0)}}class v{static decide(e){let t="unknown";return x.isDefaultForceDirectedGraphTypeGuard(e)&&(t="defaultForceDirectedGraph"),b.isBeansJson(e)&&(t="actuatorBeansJson"),m.isDefaultTreeGraphTypeGuard(e)&&(t="defaultTreeGraph"),console.log("decided input json type - "+t,e),t}}function j(e){let{validationTypeFromParent:t,parentCallback:r}=e,[a,o]=(0,s.useState)(!1),l=(0,s.useRef)(null),[i,c]=(0,s.useState)([]),[d,u]=(0,s.useState)("");async function h(){var e;let n="json"===t?g.validate(i):{isValid:!1,errorMessage:"Invalid validation type"};if(n.isValid){let e=await f(i[0]);console.log("handleSubmitFile() - ",e),function(e){let t=v.decide(e);"unknown"===t?(c([]),u("The file passed is json however the content of the file is not supported and does not seem to be from actuator")):r(e,t)}(e)}else c([]),u(n.errorMessage)}let f=async e=>{let t=new FileReader;return new Promise((r,n)=>{t.onload=e=>{var t;let s=null===(t=e.target)||void 0===t?void 0:t.result;try{let e=JSON.parse(s);r(e)}catch(e){console.error("Error parsing JSON:",e),n(e)}},t.onerror=e=>{console.error("Error reading file:",e),n(e)},t.readAsText(e)})};return(0,n.jsxs)("div",{className:"flex flex-col items-center m-4",children:[(0,n.jsxs)("form",{onClick:function(){l.current.value="",l.current.click()},className:"".concat(a?"bg-blue-400":"bg-blue-100","  p-8 w-2/3 h-[60vh] rounded-lg text-center flex flex-col items-center justify-center \n          hover:bg-blue-200 hover:animate-pulse"),onDragEnter:function(e){e.preventDefault(),e.stopPropagation(),o(!0)},onSubmit:e=>e.preventDefault(),onDrop:function(e){var t;if(e.preventDefault(),e.stopPropagation(),o(!1),(null===(t=e.dataTransfer)||void 0===t?void 0:t.files)&&e.dataTransfer.files[0])for(let t=0;t<e.dataTransfer.files.length;t++)c(r=>{var n;return[...r,null===(n=e.dataTransfer)||void 0===n?void 0:n.files[t]]})},onDragLeave:function(e){e.preventDefault(),e.stopPropagation(),o(!1)},onDragOver:function(e){e.preventDefault(),e.stopPropagation(),o(!0)},children:[(0,n.jsx)("input",{placeholder:"fileInput",className:"hidden",ref:l,type:"file",multiple:!1,onChange:function(e){if(e.preventDefault(),console.log("File has been added"),u(""),e.target.files&&e.target.files[0]){console.log(e.target.files);for(let t=0;t<e.target.files.length;t++)c(r=>[...r,e.target.files[t]])}},accept:".json"}),(0,n.jsx)("p",{className:"text-gray-500",children:"Drag & Drop files or Select files to upload"})]}),(0,n.jsx)("button",{className:"bg-teal-600 rounded-lg p-5 mt-3 w-auto",onClick:h,children:(0,n.jsx)("span",{className:"p-2 text-white",children:"Process"})}),(null==d?void 0:d.length)==0?null:(0,n.jsx)("div",{className:"bg-red-700 text-white opacity-50 rounded-xl p-2 mt-3 w-auto",children:d}),i.map((e,t)=>(0,n.jsxs)("div",{className:"flex flex-row space-x-5",children:[(0,n.jsx)("span",{children:e.name}),(0,n.jsx)("span",{className:"text-red-500 cursor-pointer",onClick:()=>(function(e,t){let r=[...i];r.splice(t,1),c([]),c(r),u("")})(e.name,t),children:"remove"})]},t))]})}function w(){let[e,t]=(0,s.useState)(),[r,a]=(0,s.useState)("unknown");return(0,n.jsx)("main",{className:"flex flex-col border-8 border-black min-h-[80vh]",children:void 0===e?(0,n.jsx)("section",{className:"border-8 border-red-300",children:(0,n.jsx)(j,{validationTypeFromParent:"json",parentCallback:(e,r)=>{console.log("inside page dragNdrop callback"),console.log(e),a(r),t(e)}})}):(0,n.jsx)("section",{children:(0,n.jsx)(h,{actualJsonData:e,actuatorType:r,parentCallback:e=>{console.log("inside page canvas callback"),console.log(e),t(e)}})})})}}},function(e){e.O(0,[944,971,69,744],function(){return e(e.s=4447)}),_N_E=e.O()}]);